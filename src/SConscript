Import('RTT_ROOT')
Import('rtconfig')
from building import *

src = Split('''
device.c
thread.c
scheduler.c
timer.c
irq.c
kservice.c
clock.c
object.c
mempool.c
ipc.c
idle.c
''')

CPPPATH = [RTT_ROOT + '/include']
if rtconfig.CROSS_TOOL == 'keil' and GetDepend('RT_USING_MODULE') == True:
    LINKFLAGS = ' --keep __rtmsym_* '
else:
    LINKFLAGS = '' 

if GetDepend('RT_USING_MODULE'):
    src += Split('rtm.c')
    src += Split('module.c')

if GetDepend('RT_USING_SLAB'):
    src += Split('slab.c')
else:
    src += Split('mem.c')

group   = DefineGroup('Kernel', src, depend = [''], CPPPATH = CPPPATH, LINKFLAGS = LINKFLAGS)

Return('group')
